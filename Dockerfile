FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBGYWxzZQphc3luYzogb3B0aW9uYWwKdGFnczog\
CiAgLSBtb2JpbGUtc2VydmljZQptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogQWVyb0dlYXIgVVBT\
CiAgaW1hZ2VVcmw6ICJodHRwczovL3Bicy50d2ltZy5jb20vcHJvZmlsZV9pbWFnZXMvMTc5NDQ0\
MDAwNS9hZXJvZ2Vhcl9pY29uLTFfNDAweDQwMC5wbmciCiAgZG9jdW1lbnRhdGlvblVybDogImh0\
dHBzOi8vYWVyb2dlYXIub3JnL3B1c2giCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQs\
IEluYy4iCiAgZGVwZW5kZW5jaWVzOiBbJ015U1FMOjU1J10KICBzZXJ2aWNlTmFtZTogdXBzCnBs\
YW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IERlcGxveSBVUFMKICAgIGZy\
ZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczogCiAgICAtIG5hbWU6IE1Z\
U1FMX1VTRVIKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgZGVmYXVsdDogdW5pZmllZHB1c2gK\
ICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBVUFMgZGIgdXNlcm5hbWUKICAgIC0gbmFt\
ZTogTVlTUUxfUEFTU1dPUkQKICAgICAgZGVzY3JpcHRpb246IChnZW5lcmF0ZWQgaWYgbGVmdCBi\
bGFuaykKICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRs\
ZTogVVBTIGRiIHBhc3N3b3JkCiAgICAtIG5hbWU6IE1ZU1FMX1JPT1RfUEFTU1dPUkQKICAgICAg\
ZGVzY3JpcHRpb246IChnZW5lcmF0ZWQgaWYgbGVmdCBibGFuaykKICAgICAgcmVxdWlyZWQ6IEZh\
bHNlCiAgICAgIHR5cGU6IHN0cmluZwogICAgICB0aXRsZTogVVBTIGRiIHJvb3QgcGFzc3dvcmQK\
ICAgIC0gbmFtZTogTVlTUUxfREFUQUJBU0UKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgZGVm\
YXVsdDogdW5pZmllZHB1c2gKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBVUFMgZGF0\
YWJhc2UgbmFtZQogICAgLSBuYW1lOiBNWVNRTF9WRVJTSU9OCiAgICAgIHJlcXVpcmVkOiBUcnVl\
CiAgICAgIGRlZmF1bHQ6ICI1NSIKICAgICAgZW51bTogWyc1NScsICc1NiddCiAgICAgIHR5cGU6\
IGVudW0KICAgICAgdGl0bGU6IE15U1FMIHZlcnNpb24="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
